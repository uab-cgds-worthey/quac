# general statistics table config
table_columns_visible:
    QualiMap:
        1_x_pc: False
        5_x_pc: False
        10_x_pc: False
        20_x_pc: False
        50_x_pc: False
        60_x_pc: False
        100_x_pc: False
        200_x_pc: False

    Picard:
        MEDIAN_COVERAGE: False
        PCT_30X: False

    "Bcftools Stats":
        number_of_SNPs: False
        number_of_indels: False

    Samtools:
        non-primary_alignments: False
        reads_mapped: False
        reads_mapped_percent: False
        raw_total_sequences: False

    "FastQC (raw)": False

table_columns_placement:
    verifybamid: 900

# order of modules to show in report
module_order:
    - cgds_qc_checkup
    - qualimap
    - picard
    - samtools
    - bcftools
    - fastqc:
          name: "FastQC (trimmed)"
          anchor: "trimmed"
          info: "This section of the report shows FastQC results after adapter trimming."
          target: ""
          path_filters:
              - "*/qc/fastqc-trimmed/*_fastqc.zip"
    - fastqc:
          name: "FastQC (raw)"
          anchor: "raw"
          path_filters:
              - "*/qc/fastqc-raw/*_fastqc.zip"
    - fastq_screen:
          name: "FastQ Screen (trimmed)"
          path_filters:
              - "*/qc/fastq_screen-trimmed/*"
    - verifybamid
    - somalier

# qualimap related
qualimap_config:
    general_stats_coverage:
        - 1
        - 5
        - 10
        - 15
        - 20
        - 30
        - 40
        - 50
        - 60
        - 100
        - 200

# configs for CGDS QC check-ups
# NOTE: This multiqc config file has hard-coded parameters, which is based on the QC-checkup config file.
# If parameters in QC-checkup config file get modified, this file may need to be edited correspondingly.
custom_data:
    qc_checkup_overall_summary:
        parent_id: "cgds_qc_checkup"
        parent_name: "CGDS - QC checkup"
        parent_description: "This section contains CGDS's QC checking results (Might not work well for WES)."
        id: "qc_checkup_overall_summary"
        section_name: "Overall QC checkup summary"
        description: "OverallÂ QC checkup summary of results from several QC tools"
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "Overall QC checkup summary"

    qc_checkup_fastqc:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_fastqc"
        section_name: "FastQC (trimmed)"
        description: 'Quick summary of FastQC (trimmed) results. See <a href="#trimmed">FastQC</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "FastQC - QC checkup"

    qc_checkup_qualimap_overall:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_qualimap_overall"
        section_name: "Qualimap - Overall stats"
        description: 'Quick summary of Qualimap results. See <a href="#qualimap">QualiMap</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "Qualimap - Overall stats - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
            avg_gc_val:
                min: 40.5
                max: 42.5
                description: "Mean GC content (min: 40.5, max: 42.5)"
                hidden: True
            # if you change coverage limits, also change values in "qc_checkup_qualimap_chromosome_stats"
            mean_coverage_val:
                min: 100
                description: "Mean coverage (min: 100)"
                hidden: True
            median_coverage_val:
                min: 100
                description: "Median coverage (min: 100)"
                hidden: True
            percentage_aligned_val:
                min: 99
                max: 100
                description: "% mapped reads (min: 99, max: 100)"
                hidden: True
            "mean_cov:median_cov_val":
                min: 0.9
                max: 1.1
                description: "Ratio of Mean coverage to Median coverage (min: 0.9, max: 1.1)"
                hidden: True
            median_insert_size_val:
                min: 250
                description: "Median insert size (min: 250)"
                hidden: True

    qc_checkup_qualimap_chromosome_stats:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_qualimap_chromosome_stats"
        section_name: "Qualimap - Chromosome stats"
        description: 'Quick summary chromosome-level coverage info using Qualimap results. See <a href="#qualimap">QualiMap</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "linegraph"
        pconfig:
            id: qc_checkup_qualimap_chromosome_stats
            ymin: 0
            ymax: 100
            categories: True
            ylab: "Coverage (X)"
            extra_series:
                name: "Minimum required"
                data: [[0, 100], [21, 100], [22, 50.0], [23, 50.0]]
                dashStyle: "Dash"
                showInLegend: False
                color: "PaleVioletRed"

    qc_checkup_picard:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_picard"
        section_name: "Picard"
        description: 'Quick summary of picard metrics. Note: Picard-Duplication is reported separately (bcoz reasons!).  See <a href="#picard-1">Picard</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "Picard - Overall stats - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
            PCT_PF_READS_ALIGNED_val:
                min: 98
                max: 100
                description: "% of Pass filter (PF) reads that aligned to the reference sequence. PF_READS_ALIGNED / PF_READS (min: 98, max: 100)"
                hidden: True
            PF_HQ_ALIGNED_Q20_BASES_val:
                min: 1.0E+11
                description: "The subset of PF_HQ_ALIGNED_BASES where the base call quality was Q20 or higher. (min: 1.0E+11)"
                hidden: True
            PCT_ADAPTER_val:
                min: 0
                max: 0.2
                description: "% of Pass filter(PF) reads that are unaligned and match to a known adapter sequence right from the start of the read. (min: 0, max: 0.2)"
                hidden: True
            PCT_CHIMERAS_val:
                min: 0
                max: 1
                description: "The fraction of reads that map outside of a maximum insert size (usually 100kb) or that have the two ends mapping to different chromosomes. (min: 0, max: 1)"
                hidden: True
            Q30_BASES_val:
                min: 8.0E+10
                description: "The number of bases in all reads that achieve quality score 30 or higher (min: 8.0E+10)"
                hidden: True
            perc_Q30_BASES_val:
                min: 85
                description: "% of bases in all reads that achieve quality score 30 or higher (min: 85)"
                hidden: True
            PCT_EXC_TOTAL_val:
                min: 0
                max: 15
                description: "% of aligned bases excluded due to all filters. (min: 0, max: 15)"
                hidden: True
            PCT_15X_val:
                min: 90
                max: 100
                description: "% of bases that attained at least 15X sequence coverage in post-filtering bases. (min: 90, max: 100)"
                hidden: True
            PCT_PF_READS_ALIGNED:
                description: "% of Pass filter (PF) reads that aligned to the reference sequence. PF_READS_ALIGNED / PF_READS"
            PF_HQ_ALIGNED_Q20_BASES:
                description: "The subset of PF_HQ_ALIGNED_BASES where the base call quality was Q20 or higher."
            PCT_ADAPTER:
                description: "% of Pass filter(PF) reads that are unaligned and match to a known adapter sequence right from the start of the read."
            PCT_CHIMERAS:
                description: "The fraction of reads that map outside of a maximum insert size (usually 100kb) or that have the two ends mapping to different chromosomes."
            Q30_BASES:
                description: "The number of bases in all reads that achieve quality score 30 or higher"
            perc_Q30_BASES:
                description: "% of bases in all reads that achieve quality score 30 or higher"
            PCT_EXC_TOTAL:
                description: "% of aligned bases excluded due to all filters."
            PCT_15X:
                description: "% of bases that attained at least 15X sequence coverage in post-filtering bases."

    qc_checkup_picard_dups:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_picard_dups"
        section_name: "Picard-dups"
        description: 'Quick summary of picard-duplication metrics. See <a href="#picard-1">Picard</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "Picard duplication - Overall stats - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
            PERCENT_DUPLICATION_val:
                min: 0
                max: 15
                description: "% of mapped reads that are marked as duplicates (min: 0, max: 15)"
                hidden: True

    qc_checkup_bcftools_stats:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_bcftools_stats"
        section_name: "Bcftools stats"
        description: 'Quick summary of Bcftools-stats results. See <a href="#bcftools">Bcftools</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "Bcftools stats - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
            number_of_records_val:
                min: 8.2E+04
                max: 1.0E+05
                description: "Total number of variants (min: 8.2E+04, max: 1.0E+05)"
                hidden: True
            number_of_SNPs_val:
                min: 7.2E+04
                max: 9.0E+04
                description: "Total number of SNPs (min: 7.2E+04, max: 9.0E+04)"
                hidden: True
            number_of_indels_val:
                min: 9.5E+03
                max: 1.3E+04
                description: "Total number of Indels (min: 9.5E+03, max: 1.3E+04)"
                hidden: True
            perc_snps_val:
                min: 86
                max: 89
                description: "%SNPs among all variants (min: 86, max: 89)"
                hidden: True
            perc_indels_val:
                min: 11
                max: 14
                description: "%Indels among all variants (min: 11, max: 14)"
                hidden: True
            tstv_val:
                min: 2.3
                max: 2.5
                description: "Transition to Transversion ratio (min: 2.3, max: 2.5)"
                hidden: True
            heterozygosity_ratio_val:
                min: 1.6
                max: 2.5
                description: "No. of het sites in an individual divided by the no. of non-reference hom sites. Note: This varies heavily across populations. (min: 1.6, max: 2.5)"
                hidden: True
            number_of_records:
                description: "Total number of variants"
            number_of_SNPs:
                description: "Total number of SNPs"
            number_of_indels:
                description: "Total number of Indels"
            perc_snps:
                description: "%SNPs among all variants"
            perc_indels:
                description: "%Indels among all variants"
            tstv:
                description: "Transition to Transversion ratio"
            heterozygosity_ratio:
                description: "No. of het sites in an individual divided by the no. of non-reference hom sites. Note: This varies heavily across populations."

    qc_checkup_variant_per_contig:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_variant_per_contig"
        section_name: "Variant frequency per contig"
        description: "Quick summary of %variant per contig results."
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "%Variant per contig - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
        headers:
            chr1_val:
                min: 0.003
                max: 0.004
                description: "chr1 (min: 0.003, max: 0.004)"
                format: '{:,.4f}'
                hidden: True
            chr2_val:
                min: 0.002
                max: 0.003
                description: "chr2 (min: 0.002, max: 0.003)"
                format: '{:,.4f}'
                hidden: True
            chr3_val:
                min: 0.002
                max: 0.003
                description: "chr3 (min: 0.002, max: 0.003)"
                format: '{:,.4f}'
                hidden: True
            chr4_val:
                min: 0.0016
                max: 0.0022
                description: "chr4 (min: 0.0016, max: 0.0022)"
                format: '{:,.4f}'
                hidden: True
            chr5_val:
                min: 0.0018
                max: 0.0025
                description: "chr5 (min: 0.0018, max: 0.0025)"
                format: '{:,.4f}'
                hidden: True
            chr6_val:
                min: 0.002
                max: 0.0036
                description: "chr6 (min: 0.002, max: 0.0036)"
                format: '{:,.4f}'
                hidden: True
            chr7_val:
                min: 0.0028
                max: 0.0036
                description: "chr7 (min: 0.0028, max: 0.0036)"
                format: '{:,.4f}'
                hidden: True
            chr8_val:
                min: 0.0019
                max: 0.0026
                description: "chr8 (min: 0.0019, max: 0.0026)"
                format: '{:,.4f}'
                hidden: True
            chr9_val:
                min: 0.0021
                max: 0.0031
                description: "chr9 (min: 0.0021, max: 0.0031)"
                format: '{:,.4f}'
                hidden: True
            chr10_val:
                min: 0.0025
                max: 0.0032
                description: "chr10 (min: 0.0025, max: 0.0032)"
                format: '{:,.4f}'
                hidden: True
            chr11_val:
                min: 0.0035
                max: 0.0043
                description: "chr11 (min: 0.0035, max: 0.0043)"
                format: '{:,.4f}'
                hidden: True
            chr12_val:
                min: 0.0031
                max: 0.0041
                description: "chr12 (min: 0.0031, max: 0.0041)"
                format: '{:,.4f}'
                hidden: True
            chr13_val:
                min: 0.0013
                max: 0.0017
                description: "chr13 (min: 0.0013, max: 0.0017)"
                format: '{:,.4f}'
                hidden: True
            chr14_val:
                min: 0.0026
                max: 0.0037
                description: "chr14 (min: 0.0026, max: 0.0037)"
                format: '{:,.4f}'
                hidden: True
            chr15_val:
                min: 0.0022
                max: 0.0032
                description: "chr15 (min: 0.0022, max: 0.0032)"
                format: '{:,.4f}'
                hidden: True
            chr16_val:
                min: 0.0037
                max: 0.0053
                description: "chr16 (min: 0.0037, max: 0.0053)"
                format: '{:,.4f}'
                hidden: True
            chr17_val:
                min: 0.0052
                max: 0.007
                description: "chr17 (min: 0.0052, max: 0.007)"
                format: '{:,.4f}'
                hidden: True
            chr18_val:
                min: 0.0015
                max: 0.002
                description: "chr18 (min: 0.0015, max: 0.002)"
                format: '{:,.4f}'
                hidden: True
            chr19_val:
                min: 0.0097
                max: 0.0131
                description: "chr19 (min: 0.0097, max: 0.0131)"
                format: '{:,.4f}'
                hidden: True
            chr20_val:
                min: 0.0029
                max: 0.0039
                description: "chr20 (min: 0.0029, max: 0.0039)"
                format: '{:,.4f}'
                hidden: True
            chr21_val:
                min: 0.0021
                max: 0.0031
                description: "chr21 (min: 0.0021, max: 0.0031)"
                format: '{:,.4f}'
                hidden: True
            chr22_val:
                min: 0.0034
                max: 0.0046
                description: "chr22 (min: 0.0034, max: 0.0046)"
                format: '{:,.4f}'
                hidden: True
            chrX_val:
                min: 0.0007
                max: 0.0015
                description: "chrX (min: 0.0007, max: 0.0015)"
                format: '{:,.4f}'
                hidden: True
            chrY_val:
                min: 2e-05
                max: 6e-05
                description: "chrY (min: 2e-05, max: 6e-05)"
                format: '{:,.6f}'
                hidden: True

    qc_checkup_verifybamid:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_verifybamid"
        section_name: "VerifyBAMID"
        description: 'Quick summary of VerifyBAMID results. See <a href="#verifybamid-1">VerifyBAMID</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "VerifyBAMID - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
            FREEMIX_val:
                min: 0
                max: 2
                description: "% Cross-human-sample contamination (min: 0, max: 2)"
                title: "Contamination(%)_val"
                hidden: True
            FREEMIX:
                title: "Contamination(%)"
                description: "% Cross-human-sample contamination"

    qc_checkup_fastq_screen:
        parent_id: "cgds_qc_checkup"
        id: "qc_checkup_fastq_screen"
        section_name: "FastQ Screen (trimmed)"
        description: 'Quick summary of FastQ Screen (trimmed) results. See <a href="#fastq_screen-1">FastQ Screen</a> section below for detailed results.'
        file_format: "yaml"
        plot_type: "table"
        pconfig:
            table_title: "FastQ Screen - QC checkup"
            only_defined_headers: False
            scale: "Blues"
        headers:
            "%Human":
                placement: 900
            "%Mouse":
                placement: 920
            "%Rat":
                placement: 940
            "%No hits":
                placement: 960
            "%Human_val":
                min: 98.5
                max: 100
                description: "%Human (min: 98.5, max: 100)"
                hidden: True
                placement: 910
            "%Mouse_val":
                min: 8.1
                max: 11
                description: "%Mouse (min: 8.1, max: 11)"
                hidden: True
                placement: 930
            "%Rat_val":
                min: 9.0
                max: 11
                description: "%Rat (min: 9.0, max: 11)"
                hidden: True
                placement: 950
            "%Drosophila_val":
                min: 1.1
                max: 1.8
                description: "%Drosophila (min: 1.1, max: 1.8)"
                hidden: True
            "%Arabidopsis_val":
                min: 0.8
                max: 1.2
                description: "%Arabidopsis (min: 0.8, max: 1.2)"
                hidden: True
            "%No hits_val":
                min: 0
                max: 1
                description: "%No hits (min: 0, max: 1)"
                hidden: True
                placement: 970
            "%Adapters_val":
                min: 0
                max: 1.0
                description: "%Adapters (min: 0, max: 1.0)"
                hidden: True
            "%Ecoli_val":
                min: 0
                max: 1.0
                description: "%Ecoli (min: 0, max: 1.0)"
                hidden: True
            "%Lambda_val":
                min: 0
                max: 1.0
                description: "%Lambda (min: 0, max: 1.0)"
                hidden: True
            "%MT_val":
                min: 0
                max: 1.0
                description: "%MT (min: 0, max: 1.0)"
                hidden: True
            "%PhiX_val":
                min: 0
                max: 1.0
                description: "%PhiX (min: 0, max: 1.0)"
                hidden: True
            "%Vectors_val":
                min: 0
                max: 1.0
                description: "%Vectors (min: 0, max: 1.0)"
                hidden: True
            "%Worm_val":
                min: 0
                max: 1.0
                description: "%Worm (min: 0, max: 1.0)"
                hidden: True
            "%Yeast_val":
                min: 0
                max: 1.0
                description: "%Yeast (min: 0, max: 1.0)"
                hidden: True
            "%rRNA_val":
                min: 0
                max: 1.0
                description: "%rRNA (min: 0, max: 1.0)"
                hidden: True


# define file pattern for custom configs
sp:
    qc_checkup_overall_summary:
        fn: "qc_checkup_overall_summary.yaml"
    qc_checkup_fastqc:
        fn: "qc_checkup_fastqc.yaml"
    qc_checkup_qualimap_overall:
        fn: "qc_checkup_qualimap_overall.yaml"
    qc_checkup_qualimap_chromosome_stats:
        fn: "qc_checkup_qualimap_chromosome_stats.yaml"
    qc_checkup_picard:
        fn: "qc_checkup_picard.yaml"
    qc_checkup_picard_dups:
        fn: "qc_checkup_picard_dups.yaml"
    qc_checkup_bcftools_stats:
        fn: "qc_checkup_bcftools_stats.yaml"
    qc_checkup_variant_per_contig:
        fn: "qc_checkup_variant_per_contig.yaml"
    qc_checkup_verifybamid:
        fn: "qc_checkup_verifybamid.yaml"
    qc_checkup_fastq_screen:
        fn: "qc_checkup_fastq_screen.yaml"